"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[741],{15761:function(ae,R,t){t.r(R),t.d(R,{default:function(){return re}});var L=t(48305),B=t.n(L),N=t(90228),z=t.n(N),O=t(87999),W=t.n(O),G=t(15558),T=t.n(G),J=t(36075),Q=t.n(J),Y=t(3533),$=t(49130),K=t(16064),l=t(71732),c=t(7589),F=t(43002),V=t(51114),P=t(59337),m=t(28151),d=t(75271),e=t(52676),X=c.Z.Header,k=c.Z.Content,A=F.Z.Text,w=function(f){Q()(f);var h=(0,l.useDispatch)(),g=(0,d.useState)(""),v=B()(g,2),x=v[0],S=v[1],u=(0,l.useSelector)(function(s){return s.conversation}),i=u.userIsFocus,j=(0,l.useSelector)(function(s){return s.auth}),Z=j.authData,b=(0,d.useState)([]),D=B()(b,2),E=D[0],a=D[1],n=function(){if(x===""){V.ZP.error("Please fill in text input");return}h({type:"conversation/sendMessage",payload:x}),S("")};(0,d.useEffect)(function(){var s=Y.O.channel("supabase_realtime").on("postgres_changes",{event:"*",schema:"public",table:"messages"},function(r){r.new&&a(function(o){return[].concat(T()(o),[typeof r.new=="string"?JSON.parse(r.new):r.new])})});s.subscribe(function(r){r==="SUBSCRIBED"&&console.log("Successfully subscribed to the channel")}),console.log("first")},[]);var y=function(){var s=W()(z()().mark(function r(o){var M;return z()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,(0,$.rb)(o);case 2:M=p.sent,a(M);case 4:case"end":return p.stop()}},r)}));return function(o){return s.apply(this,arguments)}}();return(0,d.useEffect)(function(){i.conversation_id!==""&&y(i.conversation_id)},[i]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(X,{style:{background:"#f5f5f5",padding:"16px 24px",borderBottom:"1px solid #e8e8e8",fontSize:20,fontWeight:700,display:"flex",alignItems:"center"},children:[(0,e.jsx)("img",{src:i.avatar,style:{height:50,width:50,borderRadius:9999,objectFit:"cover",display:"block",margin:10}}),(0,e.jsx)(A,{strong:!0,style:{fontSize:"18px"},children:i.name})]}),(0,e.jsx)(k,{style:{flex:1,padding:"24px",backgroundColor:"#f9f9f9",overflowY:"auto",display:"flex",flexDirection:"column-reverse"},children:T()(E).reverse().map(function(s,r){var o=s.sender_id===String(Z.user.id);return(0,e.jsx)("div",{style:{alignSelf:o?"flex-end":"flex-start",background:o?"#1677ff":"#e4e6eb",color:o?"#fff":"#000",padding:"12px 18px",borderRadius:20,maxWidth:"65%",marginTop:10,boxShadow:"0 2px 5px rgba(0, 0, 0, 0.08)",wordBreak:"break-word"},children:(0,e.jsx)(A,{style:{fontSize:"15px"},children:s.message})},r)})}),(0,e.jsxs)("div",{style:{display:"flex",padding:"16px",background:"#fff",borderTop:"1px solid #e8e8e8"},children:[(0,e.jsx)(P.Z,{value:x,onChange:function(r){return S(r.target.value)},placeholder:"Nh\u1EADp tin nh\u1EAFn...",style:{flex:1,marginRight:12,borderRadius:24,padding:"8px 16px",fontSize:16}}),(0,e.jsx)(m.ZP,{type:"primary",icon:(0,e.jsx)(K.Z,{}),onClick:n,style:{borderRadius:24,padding:"0 20px",height:40}})]})]})},q=w,_=t(71234),ee=t(82484),te=t(31866),H=t(31974),C=t(26665),U=t(22326),oe=c.Z.Header,ie=c.Z.Content,I=F.Z.Text,ne=function(){var f=(0,l.useDispatch)(),h=(0,l.useSelector)(function(a){return a.conversation}),g=h.profileSearch,v=h.historyConversation,x=h.userIsFocus,S=(0,l.useSelector)(function(a){return a.auth}),u=S.authData,i=(0,d.useState)(""),j=B()(i,2),Z=j[0],b=j[1],D=function(){f({type:"conversation/searchUserByName",payload:Z})},E=function(n,y,s,r){f({type:"conversation/getInfoUser",payload:{selfId:u.user.id,userId:n,name:s,avatar:y,is_online:r}})};return(0,d.useEffect)(function(){(0,_.Qr)(u)||f({type:"conversation/getListHistoryConversation",payload:u.user.id})},[g,u]),(0,e.jsx)(c.Z,{style:{minHeight:"100vh",maxHeight:"100vh"},children:(0,e.jsxs)(te.Z,{gutter:16,style:{height:"100%"},children:[(0,e.jsxs)(H.Z,{span:6,style:{borderRight:"1px solid #f0f0f0",paddingLeft:"30px",paddingRight:"30px",paddingTop:30,display:"flex",flexDirection:"column",height:"100vh",background:"#fff"},children:[(0,e.jsx)(I,{strong:!0,style:{marginBottom:10,fontSize:18},children:"Danh s\xE1ch cu\u1ED9c tr\xF2 chuy\u1EC7n"}),(0,e.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:16},children:[(0,e.jsx)(P.Z,{placeholder:"T\xECm ki\u1EBFm ng\u01B0\u1EDDi d\xF9ng",value:Z,onChange:function(n){return b(n.target.value)}}),(0,e.jsx)(m.ZP,{type:"default",onClick:D,style:{height:30,width:100},children:"T\xECm ki\u1EBFm"})]}),g.length>0?(0,e.jsx)(C.Z,{itemLayout:"horizontal",dataSource:g,renderItem:function(n){return(0,e.jsx)(C.Z.Item,{style:{borderBottom:"1px solid #f0f0f0"},children:(0,e.jsxs)(m.ZP,{style:{width:"100%",display:"flex",alignItems:"center",padding:"10px",borderRadius:8,transition:"0.3s",background:"#fff",marginBottom:5,border:"1px solid #ddd",height:50},onClick:function(){return E(n.id,n.avatar,n.name,n.is_online)},children:[(0,e.jsx)(U.Z,{src:n.avatar,size:40,style:{marginRight:10}}),(0,e.jsx)(I,{style:{textAlign:"left",fontSize:16},children:n.name})]})})}}):v.length===0?(0,e.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column",alignItems:"center",textAlign:"center",fontSize:16,color:"#888"},children:[(0,e.jsx)(ee.Z,{style:{fontSize:48,marginBottom:8}}),"H\xE3y k\u1EBFt n\u1ED1i v\u1EDBi m\u1ECDi ng\u01B0\u1EDDi!"]}):(0,e.jsx)(C.Z,{itemLayout:"horizontal",dataSource:v,renderItem:function(n){return(0,e.jsx)(C.Z.Item,{style:{borderBottom:"1px solid #f0f0f0"},children:(0,e.jsxs)(m.ZP,{style:{width:"100%",display:"flex",alignItems:"center",justifyItems:"left",padding:"10px",borderRadius:8,transition:"0.3s",background:"#fff",marginBottom:5,border:"1px solid #ddd",height:50},onClick:function(){console.log(n),E(n.id,n.avatar,n.name,n.is_online)},children:[(0,e.jsx)(U.Z,{src:n.avatar,size:40,style:{marginRight:10}}),(0,e.jsx)(I,{style:{textAlign:"left",fontSize:16},children:n.name})]})})}})]}),(0,e.jsx)(H.Z,{span:18,style:{display:"flex",flexDirection:"column",height:"100vh"},children:x.user_id!==""&&(0,e.jsx)(q,{})})]})})},re=ne}}]);
